<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Which Friend are You?</title>

     <!-- Link to style sheet -->
     <link rel = "stylesheet" type = "text/css" href = "assets/style.css">
     <!-- Link to Google Fonts -->
     <link href="https://fonts.googleapis.com/css?family=Permanent+Marker|Poppins&display=swap" rel="stylesheet">
      <!-- Link to jQuery -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

      <style>
          /* Survey Styling */
        #survey-page {
            background-color: rgb(246, 246, 214);
            color: black;
            text-align: center; 
        }
        .likert li {
            float: left;
            list-style-type: none;
            font-family: 'Poppins', sans-serif;
        }
        .likert {
            color: black;
            margin: auto 0;   
        }
        #survey {
            width: 45%; 
            background-color: white; 
            margin: 0 auto; 
            padding-left: 25px; 
            padding-right: 15px; 
            padding-bottom: 20px; 
            padding-top: 20px; 
            text-align: left; 
        }

        #warning {
            color: red; 
        }

        h1{
            font-family: 'Permanent Marker', cursive;
        }

        h2, h3{
            font-family: 'Poppins', sans-serif;
        }
      </style>
</head>
<body id = "survey-page">
    <img src = "./assets/images/couch.png" id = "couch" width = "600px">

    <div id = "survey">

        <h1>Question 1</h1>
        <h2>It's NYE in NYC, you are most likely...</h2>
        <ul class="likert">
            <li> In bed</li>
            <li><input type="radio" name="Q1" class="Q1" value="1" /></li>
            <li><input type="radio" name="Q1" class="Q1" value="2" /></li>
            <li><input type="radio" name="Q1" class="Q1" value="3" /></li>
            <li><input type="radio" name="Q1" class="Q1" value="4" /></li>
            <li><input type="radio" name="Q1" class="Q1" value="5" /></li>
            <li> Partying in Times Square </li>
        </ul><br>

        <h1>Question 2</h1>
        <h2>You are the wierd one in your friend group.</h2>
        <ul class="likert">
            <li> Strongly Disagree</li>
            <li><input type="radio" name="Q2" class="Q2" value="1" /></li>
            <li><input type="radio" name="Q2" class="Q2" value="2" /></li>
            <li><input type="radio" name="Q2" class="Q2" value="3" /></li>
            <li><input type="radio" name="Q2" class="Q2" value="4" /></li>
            <li><input type="radio" name="Q2" class="Q2" value="5" /></li>
            <li> Strongly Agree </li>
        </ul><br>

        <h1>Question 3</h1>
        <h2>You have a 'little bit' of OCD.</h2>
        <ul class="likert">
            <li> Strongly Disagree</li>
            <li><input type="radio" name="Q3" class="Q3" value="1" /></li>
            <li><input type="radio" name="Q3" class="Q3" value="2" /></li>
            <li><input type="radio" name="Q3" class="Q3" value="3" /></li>
            <li><input type="radio" name="Q3" class="Q3" value="4" /></li>
            <li><input type="radio" name="Q3" class="Q3" value="5" /></li>
            <li> Strongly Agree </li>
        </ul><br>

        <h1>Question 4</h1>
        <h2>How do you feel about animals?</h2>
        <ul class="likert">
            <li> LOVE THEM! We shouldn't eat them. </li>
            <li><input type="radio" name="Q4" class="Q4" value="1" /></li>
            <li><input type="radio" name="Q4" class="Q4" value="2" /></li>
            <li><input type="radio" name="Q4" class="Q4" value="3" /></li>
            <li><input type="radio" name="Q4" class="Q4" value="4" /></li>
            <li><input type="radio" name="Q4" class="Q4" value="5" /></li>
            <li> They taste good. </li>
        </ul><br>

        <h1>Question 5</h1>
        <h2>In an argument, what are you most likely to do?</h2>
        <ul class="likert">
            <li> Back down </li>
            <li><input type="radio" name="Q5" class="Q5" value="1" /></li>
            <li><input type="radio" name="Q5" class="Q5" value="2" /></li>
            <li><input type="radio" name="Q5" class="Q5" value="3" /></li>
            <li><input type="radio" name="Q5" class="Q5" value="4" /></li>
            <li><input type="radio" name="Q5" class="Q5" value="5" /></li>
            <li> Lose your temper </li>
        </ul><br>

        <h1>Question 6</h1>
        <h2>What's your family like?</h2>
        <ul class="likert">
            <li> Small but close! </li>
            <li><input type="radio" name="Q6" class="Q6" value="1" /></li>
            <li><input type="radio" name="Q6" class="Q6" value="2" /></li>
            <li><input type="radio" name="Q6" class="Q6" value="3" /></li>
            <li><input type="radio" name="Q6" class="Q6" value="4" /></li>
            <li><input type="radio" name="Q6" class="Q6" value="5" /></li>
            <li> Busy with lots of people </li>
        </ul><br>

        <h1>Question 7</h1>
        <h2>What are you like when you play games?</h2>
        <ul class="likert">
            <li> Just happy to take part! </li>
            <li><input type="radio" name="Q7" class="Q7" value="1" /></li>
            <li><input type="radio" name="Q7" class="Q7" value="2" /></li>
            <li><input type="radio" name="Q7" class="Q7" value="3" /></li>
            <li><input type="radio" name="Q7" class="Q7" value="4" /></li>
            <li><input type="radio" name="Q7" class="Q7" value="5" /></li>
            <li> Super competitive </li>
        </ul><br>

        <h1>Question 8</h1>
        <h2>You often do not understand what your friends are talking about.</h2>
        <ul class="likert">
            <li> Strongly Disagree </li>
            <li><input type="radio" name="Q8" class="Q8" value="1" /></li>
            <li><input type="radio" name="Q8" class="Q8" value="2" /></li>
            <li><input type="radio" name="Q8" class="Q8" value="3" /></li>
            <li><input type="radio" name="Q8" class="Q8" value="4" /></li>
            <li><input type="radio" name="Q8" class="Q8" value="5" /></li>
            <li> Strongly Agree </li>
        </ul><br>

        <h1>Question 9</h1>
        <h2>You're the nerd in your friend group.</h2>
        <ul class="likert">
            <li> Strongly Disagree </li>
            <li><input type="radio" name="Q9" class="Q9" value="1" /></li>
            <li><input type="radio" name="Q9" class="Q9" value="2" /></li>
            <li><input type="radio" name="Q9" class="Q9" value="3" /></li>
            <li><input type="radio" name="Q9" class="Q9" value="4" /></li>
            <li><input type="radio" name="Q9" class="Q9" value="5" /></li>
            <li> Strongly Agree </li>
        </ul><br>

        <h1>Question 10</h1>
        <h2> How you doin ;)?</h2>
        <ul class="likert">
            <li> Strongly Disagree </li>
            <li><input type="radio" name="Q10" class="Q10" value="1" /></li>
            <li><input type="radio" name="Q10" class="Q10" value="2" /></li>
            <li><input type="radio" name="Q10" class="Q10" value="3" /></li>
            <li><input type="radio" name="Q10" class="Q10" value="4" /></li>
            <li><input type="radio" name="Q10" class="Q10" value="5" /></li>
            <li> Strongly Agree </li>
        </ul><br><br><br>

        <button id = "submit">Submit</button>
        <h3 id = "warning"></h3>
    </div>

    <div id = "results">
        <h1>Your Friends Character is...</h1>
        <h2 id = "character"></h2>
        <img id = "characterImage" width = "500px"><br>
        <button id = "clear">Clear Survey</button>
    </div>


    <!-- Javascript starts here -->
    <script type = "text/javascript">

    var newSurvey;
    var differenceArray;
    var orderedDifference;
    var Q1Answer; 
    var Q2Answer;
    var Q3Answer;
    var Q4Answer;
    var Q5Answer;
    var Q6Answer;
    var Q7Answer;
    var Q8Answer;
    var Q9Answer;
    var Q10Answer;

    $("input:radio").on("click", function(){
        questionNum = $(this).attr("class")
        questionVal = parseFloat($(this).attr("value"))

        if (questionNum === "Q1"){
            Q1Answer = questionVal
        } else if (questionNum === "Q2"){
            Q2Answer = questionVal
        } else if (questionNum === "Q3"){
            Q3Answer = questionVal
        } else if (questionNum === "Q4"){
            Q4Answer = questionVal
        } else if (questionNum === "Q5"){
            Q5Answer = questionVal
        } else if (questionNum === "Q6"){
            Q6Answer = questionVal
        } else if (questionNum === "Q7"){
            Q7Answer = questionVal
        } else if (questionNum === "Q8"){
            Q8Answer = questionVal
        } else if (questionNum === "Q9"){
            Q9Answer = questionVal
        } else if (questionNum === "Q10"){
            Q10Answer = questionVal
        };
    });

    $("#submit").on("click", function(event){
        event.preventDefault();

        if (!Q1Answer || !Q2Answer || !Q3Answer || !Q4Answer || !Q5Answer || !Q6Answer || !Q7Answer || !Q8Answer || !Q9Answer || !Q10Answer){
            $("#warning").text("Please answer all questions!")
            console.log("fuck")
        } else {
            $("#warning").text("")
            newSurvey = {
                Q1: Q1Answer,
                Q2: Q2Answer,
                Q3: Q3Answer,
                Q4: Q4Answer,
                Q5: Q5Answer,
                Q6: Q6Answer,
                Q7: Q7Answer,
                Q8: Q8Answer,
                Q9: Q9Answer,
                Q10: Q10Answer,
    
            }
            console.log(newSurvey)
    
            $.post("/api/surveyResults", newSurvey, function(){
                console.log(newSurvey)
            });
    
            $.get("api/surveyResults", function(data){
                differenceArray = [];
                orderedDifference = [];
    
                for (var i = 0; i < data.length-1; i++){
                    difference = 
                    (newSurvey.Q1 - data[i].Q1) +
                    (newSurvey.Q2 - data[i].Q2) +
                    (newSurvey.Q3 - data[i].Q3) +
                    (newSurvey.Q4 - data[i].Q4) + 
                    (newSurvey.Q5 - data[i].Q5) +
                    (newSurvey.Q6 - data[i].Q6) +
                    (newSurvey.Q7 - data[i].Q7) +
                    (newSurvey.Q8 - data[i].Q8) +
                    (newSurvey.Q9 - data[i].Q9) +
                    (newSurvey.Q10 - data[i].Q10)
    
                    differenceArray.push(Math.abs(difference))
                    orderedDifference.push(Math.abs(difference))
                };
    
                orderedDifference.sort(function(a, b) { return a - b });
                console.log(differenceArray)
                console.log(orderedDifference)
                characterIndex = differenceArray.indexOf(orderedDifference[0])
                console.log(characterIndex)
                console.log(data[characterIndex].name)
                console.log(data[characterIndex].imageLink)
    
                $("#character").text(data[characterIndex].name)
                $("#characterImage").attr("src", data[characterIndex].imageLink)
            });
        };
    });

    $("#clear").on("click", function(){
        // clear radio button inputs
        $("input:radio").prop("checked",null)

        $("#character").text("")
        $("#characterImage").attr("src", "")
    });
    </script>
    
</body>
</html>